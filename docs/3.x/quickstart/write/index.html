<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-quickstart/write">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Easy Excel RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Easy Excel Atom Feed"><title data-rh="true">å†™Excel | Easy Excel</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/3.x/quickstart/write"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="å†™Excel | Easy Excel"><meta data-rh="true" name="description" content="é€šç”¨æ•°æ®ç”Ÿæˆ åé¢ä¸ä¼šé‡å¤å†™"><meta data-rh="true" property="og:description" content="é€šç”¨æ•°æ®ç”Ÿæˆ åé¢ä¸ä¼šé‡å¤å†™"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/3.x/quickstart/write"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/3.x/quickstart/write" hreflang="zh"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/en/docs/3.x/quickstart/write" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/3.x/quickstart/write" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.553adfbb.css">
<link rel="preload" href="/assets/js/runtime~main.9214ad1a.js" as="script">
<link rel="preload" href="/assets/js/main.834bc3ec.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">è·³åˆ°ä¸»è¦å†…å®¹</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Easy Excel" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="Easy Excel" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Easy Excel</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__link--active" href="/docs/3.x/">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/qa/">å¸¸è§é—®é¢˜</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/3.x/">3.x</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/3.x/quickstart/write">3.x</a></li><li><a class="dropdown__link" href="/docs/2.x/quickstart/write">2.x</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>ä¸­æ–‡</span></span></a><ul class="dropdown__menu"><li><a href="/docs/3.x/quickstart/write" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">ä¸­æ–‡</a></li><li><a href="/en/docs/3.x/quickstart/write" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li></ul></div><a href="https://github.com/alibaba/easyexcel" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰" aria-label="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="å›åˆ°é¡¶éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/3.x/">å…³äºEasyExcel</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/3.x/quickstart/read">å¿«é€Ÿå¼€å§‹</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/3.x/quickstart/read">è¯»Excel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/3.x/quickstart/write">å†™Excel</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/3.x/quickstart/fil">å¡«å……Excel</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">ğŸ </a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">å¿«é€Ÿå¼€å§‹</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">å†™Excel</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">ç‰ˆæœ¬ï¼š3.x</span><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">æœ¬é¡µæ€»è§ˆ</button></div><div class="theme-doc-markdown markdown"><header><h1>å†™Excel</h1></header><h5 class="anchor anchorWithStickyNavbar_mojV" id="é€šç”¨æ•°æ®ç”Ÿæˆ-åé¢ä¸ä¼šé‡å¤å†™">é€šç”¨æ•°æ®ç”Ÿæˆ åé¢ä¸ä¼šé‡å¤å†™<a class="hash-link" href="#é€šç”¨æ•°æ®ç”Ÿæˆ-åé¢ä¸ä¼šé‡å¤å†™" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private List&lt;DemoData&gt; data() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;DemoData&gt; list = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        for (int i = 0; i &lt; 10; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            DemoData data = new DemoData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.setString(&quot;å­—ç¬¦ä¸²&quot; + i);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.setDate(new Date());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.setDoubleData(0.56);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            list.add(data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="ç¤ºä¾‹ä»£ç ">ç¤ºä¾‹ä»£ç <a class="hash-link" href="#ç¤ºä¾‹ä»£ç " title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>DEMOä»£ç åœ°å€ï¼š<a href="https://github.com/alibaba/easyexcel/blob/master/src/test/java/com/alibaba/easyexcel/test/demo/write/WriteTest.java" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/easyexcel/blob/master/src/test/java/com/alibaba/easyexcel/test/demo/write/WriteTest.java</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="æœ€ç®€å•çš„å†™">æœ€ç®€å•çš„å†™<a class="hash-link" href="#æœ€ç®€å•çš„å†™" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584453970149-7ed15d67-b66f-4087-9b77-d79049121792.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=245&amp;id=f024X&amp;originHeight=245&amp;originWidth=269&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=269" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class DemoData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ•°å­—æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * å¿½ç•¥è¿™ä¸ªå­—æ®µ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelIgnore</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String ignore;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç ">ä»£ç <a class="hash-link" href="#ä»£ç " title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æœ€ç®€å•çš„å†™</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void simpleWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ³¨æ„ simpleWriteåœ¨æ•°æ®é‡ä¸å¤§çš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨ï¼ˆ5000ä»¥å†…ï¼Œå…·ä½“ä¹Ÿè¦çœ‹å®é™…æƒ…å†µï¼‰ï¼Œæ•°æ®é‡å¤§å‚ç…§ é‡å¤å¤šæ¬¡å†™å…¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å†™æ³•1 JDK8+</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // since: 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;simpleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å¦‚æœè¿™é‡Œæƒ³ä½¿ç”¨03 åˆ™ ä¼ å…¥excelTypeå‚æ•°å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .sheet(&quot;æ¨¡æ¿&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(() -&gt; {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // åˆ†é¡µæŸ¥è¯¢æ•°æ®</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                return data();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å†™æ³•2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;simpleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å¦‚æœè¿™é‡Œæƒ³ä½¿ç”¨03 åˆ™ ä¼ å…¥excelTypeå‚æ•°å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).sheet(&quot;æ¨¡æ¿&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å†™æ³•3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;simpleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ExcelWriter excelWriter = null;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter = EasyExcel.write(fileName, DemoData.class).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WriteSheet writeSheet = EasyExcel.writerSheet(&quot;æ¨¡æ¿&quot;).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter.write(data(), writeSheet);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // åƒä¸‡åˆ«å¿˜è®°finish ä¼šå¸®å¿™å…³é—­æµ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (excelWriter != null) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.finish();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="æ ¹æ®å‚æ•°åªå¯¼å‡ºæŒ‡å®šåˆ—">æ ¹æ®å‚æ•°åªå¯¼å‡ºæŒ‡å®šåˆ—<a class="hash-link" href="#æ ¹æ®å‚æ•°åªå¯¼å‡ºæŒ‡å®šåˆ—" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-1">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-1" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584453996937-4c24b29d-3f50-47b3-927e-4fbcb01b3adb.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=245&amp;id=ZXzdN&amp;originHeight=245&amp;originWidth=269&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=269" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-1">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-1" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>å‚ç…§ï¼š<a href="#5bd247f4">å¯¹è±¡</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -1">ä»£ç <a class="hash-link" href="#ä»£ç -1" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æ ¹æ®å‚æ•°åªå¯¼å‡ºæŒ‡å®šåˆ—</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. æ ¹æ®è‡ªå·±æˆ–è€…æ’é™¤è‡ªå·±éœ€è¦çš„åˆ—</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 2.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void excludeOrIncludeWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;excludeOrIncludeWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œéœ€è¦æ³¨æ„ åœ¨ä½¿ç”¨ExcelPropertyæ³¨è§£çš„ä½¿ç”¨ï¼Œå¦‚æœæƒ³ä¸ç©ºåˆ—åˆ™éœ€è¦åŠ å…¥orderå­—æ®µï¼Œè€Œä¸æ˜¯index,orderä¼šå¿½ç•¥ç©ºåˆ—ï¼Œç„¶åç»§ç»­å¾€åï¼Œè€Œindexï¼Œä¸ä¼šå¿½ç•¥ç©ºåˆ—ï¼Œåœ¨ç¬¬å‡ åˆ—å°±æ˜¯ç¬¬å‡ åˆ—ã€‚</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ ¹æ®ç”¨æˆ·ä¼ å…¥å­—æ®µ å‡è®¾æˆ‘ä»¬è¦å¿½ç•¥ date</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Set&lt;String&gt; excludeColumnFiledNames = new HashSet&lt;String&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        excludeColumnFiledNames.add(&quot;date&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).excludeColumnFiledNames(excludeColumnFiledNames).sheet(&quot;æ¨¡æ¿&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;excludeOrIncludeWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ ¹æ®ç”¨æˆ·ä¼ å…¥å­—æ®µ å‡è®¾æˆ‘ä»¬åªè¦å¯¼å‡º date</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Set&lt;String&gt; includeColumnFiledNames = new HashSet&lt;String&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        includeColumnFiledNames.add(&quot;date&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).includeColumnFiledNames(includeColumnFiledNames).sheet(&quot;æ¨¡æ¿&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="æŒ‡å®šå†™å…¥çš„åˆ—">æŒ‡å®šå†™å…¥çš„åˆ—<a class="hash-link" href="#æŒ‡å®šå†™å…¥çš„åˆ—" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-2">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-2" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454018383-00194644-06a8-4e89-9d2f-99005652d4d4.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=289&amp;id=bsNnj&amp;originHeight=289&amp;originWidth=536&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=536" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-2">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-2" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class IndexData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;, index = 0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;æ—¥æœŸæ ‡é¢˜&quot;, index = 1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * è¿™é‡Œè®¾ç½®3 ä¼šå¯¼è‡´ç¬¬äºŒåˆ—ç©ºçš„</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;æ•°å­—æ ‡é¢˜&quot;, index = 3)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -2">ä»£ç <a class="hash-link" href="#ä»£ç -2" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æŒ‡å®šå†™å…¥çš„åˆ—</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link IndexData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;2. ä½¿ç”¨{@link ExcelProperty}æ³¨è§£æŒ‡å®šå†™å…¥çš„åˆ—</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;3. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void indexWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;indexWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, IndexData.class).sheet(&quot;æ¨¡æ¿&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="å¤æ‚å¤´å†™å…¥">å¤æ‚å¤´å†™å…¥<a class="hash-link" href="#å¤æ‚å¤´å†™å…¥" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-3">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-3" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454030244-62eccf86-d33b-4dac-93ec-397821957565.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=296&amp;id=kIN7D&amp;originHeight=296&amp;originWidth=298&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=298" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-3">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-3" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class ComplexHeadData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty({&quot;ä¸»æ ‡é¢˜&quot;, &quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty({&quot;ä¸»æ ‡é¢˜&quot;, &quot;æ—¥æœŸæ ‡é¢˜&quot;})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty({&quot;ä¸»æ ‡é¢˜&quot;, &quot;æ•°å­—æ ‡é¢˜&quot;})</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -3">ä»£ç <a class="hash-link" href="#ä»£ç -3" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * å¤æ‚å¤´å†™å…¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link ComplexHeadData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;2. ä½¿ç”¨{@link ExcelProperty}æ³¨è§£æŒ‡å®šå¤æ‚çš„å¤´</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;3. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void complexHeadWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;complexHeadWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, ComplexHeadData.class).sheet(&quot;æ¨¡æ¿&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="é‡å¤å¤šæ¬¡å†™å…¥å†™åˆ°å•ä¸ªæˆ–è€…å¤šä¸ªsheet">é‡å¤å¤šæ¬¡å†™å…¥(å†™åˆ°å•ä¸ªæˆ–è€…å¤šä¸ªSheet)<a class="hash-link" href="#é‡å¤å¤šæ¬¡å†™å…¥å†™åˆ°å•ä¸ªæˆ–è€…å¤šä¸ªsheet" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-4">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-4" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454058148-664960ac-69bf-4db0-92a1-4904c0f4130b.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=468&amp;id=eiNc4&amp;originHeight=468&amp;originWidth=283&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=283" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-4">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-4" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>å‚ç…§ï¼š<a href="#5bd247f4">å¯¹è±¡</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -4">ä»£ç <a class="hash-link" href="#ä»£ç -4" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * é‡å¤å¤šæ¬¡å†™å…¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link ComplexHeadData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. ä½¿ç”¨{@link ExcelProperty}æ³¨è§£æŒ‡å®šå¤æ‚çš„å¤´</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. ç›´æ¥è°ƒç”¨äºŒæ¬¡å†™å…¥å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void repeatedWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ–¹æ³•1 å¦‚æœå†™åˆ°åŒä¸€ä¸ªsheet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;repeatedWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ExcelWriter excelWriter = null;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter = EasyExcel.write(fileName, DemoData.class).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¿™é‡Œæ³¨æ„ å¦‚æœåŒä¸€ä¸ªsheetåªè¦åˆ›å»ºä¸€æ¬¡</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WriteSheet writeSheet = EasyExcel.writerSheet(&quot;æ¨¡æ¿&quot;).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // å»è°ƒç”¨å†™å…¥,è¿™é‡Œæˆ‘è°ƒç”¨äº†äº”æ¬¡ï¼Œå®é™…ä½¿ç”¨æ—¶æ ¹æ®æ•°æ®åº“åˆ†é¡µçš„æ€»çš„é¡µæ•°æ¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            for (int i = 0; i &lt; 5; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // åˆ†é¡µå»æ•°æ®åº“æŸ¥è¯¢æ•°æ® è¿™é‡Œå¯ä»¥å»æ•°æ®åº“æŸ¥è¯¢æ¯ä¸€é¡µçš„æ•°æ®</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                List&lt;DemoData&gt; data = data();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.write(data, writeSheet);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // åƒä¸‡åˆ«å¿˜è®°finish ä¼šå¸®å¿™å…³é—­æµ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (excelWriter != null) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.finish();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ–¹æ³•2 å¦‚æœå†™åˆ°ä¸åŒçš„sheet åŒä¸€ä¸ªå¯¹è±¡</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;repeatedWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¿™é‡Œ æŒ‡å®šæ–‡ä»¶</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter = EasyExcel.write(fileName, DemoData.class).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // å»è°ƒç”¨å†™å…¥,è¿™é‡Œæˆ‘è°ƒç”¨äº†äº”æ¬¡ï¼Œå®é™…ä½¿ç”¨æ—¶æ ¹æ®æ•°æ®åº“åˆ†é¡µçš„æ€»çš„é¡µæ•°æ¥ã€‚è¿™é‡Œæœ€ç»ˆä¼šå†™åˆ°5ä¸ªsheeté‡Œé¢</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            for (int i = 0; i &lt; 5; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // æ¯æ¬¡éƒ½è¦åˆ›å»ºwriteSheet è¿™é‡Œæ³¨æ„å¿…é¡»æŒ‡å®šsheetNo è€Œä¸”sheetNameå¿…é¡»ä¸ä¸€æ ·</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                WriteSheet writeSheet = EasyExcel.writerSheet(i, &quot;æ¨¡æ¿&quot; + i).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // åˆ†é¡µå»æ•°æ®åº“æŸ¥è¯¢æ•°æ® è¿™é‡Œå¯ä»¥å»æ•°æ®åº“æŸ¥è¯¢æ¯ä¸€é¡µçš„æ•°æ®</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                List&lt;DemoData&gt; data = data();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.write(data, writeSheet);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // åƒä¸‡åˆ«å¿˜è®°finish ä¼šå¸®å¿™å…³é—­æµ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (excelWriter != null) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.finish();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ–¹æ³•3 å¦‚æœå†™åˆ°ä¸åŒçš„sheet ä¸åŒçš„å¯¹è±¡</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;repeatedWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¿™é‡Œ æŒ‡å®šæ–‡ä»¶</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter = EasyExcel.write(fileName).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // å»è°ƒç”¨å†™å…¥,è¿™é‡Œæˆ‘è°ƒç”¨äº†äº”æ¬¡ï¼Œå®é™…ä½¿ç”¨æ—¶æ ¹æ®æ•°æ®åº“åˆ†é¡µçš„æ€»çš„é¡µæ•°æ¥ã€‚è¿™é‡Œæœ€ç»ˆä¼šå†™åˆ°5ä¸ªsheeté‡Œé¢</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            for (int i = 0; i &lt; 5; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // æ¯æ¬¡éƒ½è¦åˆ›å»ºwriteSheet è¿™é‡Œæ³¨æ„å¿…é¡»æŒ‡å®šsheetNo è€Œä¸”sheetNameå¿…é¡»ä¸ä¸€æ ·ã€‚è¿™é‡Œæ³¨æ„DemoData.class å¯ä»¥æ¯æ¬¡éƒ½å˜ï¼Œæˆ‘è¿™é‡Œä¸ºäº†æ–¹ä¾¿ æ‰€ä»¥ç”¨çš„åŒä¸€ä¸ªclass å®é™…ä¸Šå¯ä»¥ä¸€ç›´å˜</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                WriteSheet writeSheet = EasyExcel.writerSheet(i, &quot;æ¨¡æ¿&quot; + i).head(DemoData.class).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                // åˆ†é¡µå»æ•°æ®åº“æŸ¥è¯¢æ•°æ® è¿™é‡Œå¯ä»¥å»æ•°æ®åº“æŸ¥è¯¢æ¯ä¸€é¡µçš„æ•°æ®</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                List&lt;DemoData&gt; data = data();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.write(data, writeSheet);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // åƒä¸‡åˆ«å¿˜è®°finish ä¼šå¸®å¿™å…³é—­æµ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (excelWriter != null) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.finish();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="æ—¥æœŸæ•°å­—æˆ–è€…è‡ªå®šä¹‰æ ¼å¼è½¬æ¢">æ—¥æœŸã€æ•°å­—æˆ–è€…è‡ªå®šä¹‰æ ¼å¼è½¬æ¢<a class="hash-link" href="#æ—¥æœŸæ•°å­—æˆ–è€…è‡ªå®šä¹‰æ ¼å¼è½¬æ¢" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-5">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-5" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454076557-cabbe44e-5801-44f8-b689-385ec4ceb18d.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=313&amp;id=VIaYK&amp;originHeight=313&amp;originWidth=512&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=512" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-5">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-5" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class ConverterData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æˆ‘æƒ³æ‰€æœ‰çš„ å­—ç¬¦ä¸²èµ·å‰é¢åŠ ä¸Š&quot;è‡ªå®šä¹‰ï¼š&quot;ä¸‰ä¸ªå­—</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;, converter = CustomStringStringConverter.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æˆ‘æƒ³å†™åˆ°excel ç”¨å¹´æœˆæ—¥çš„æ ¼å¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @DateTimeFormat(&quot;yyyyå¹´MMæœˆddæ—¥HHæ—¶mmåˆ†ssç§’&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æˆ‘æƒ³å†™åˆ°excel ç”¨ç™¾åˆ†æ¯”è¡¨ç¤º</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @NumberFormat(&quot;#.##%&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;æ•°å­—æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -5">ä»£ç <a class="hash-link" href="#ä»£ç -5" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æ—¥æœŸã€æ•°å­—æˆ–è€…è‡ªå®šä¹‰æ ¼å¼è½¬æ¢</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link ConverterData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;2. ä½¿ç”¨{@link ExcelProperty}é…åˆä½¿ç”¨æ³¨è§£{@link DateTimeFormat}ã€{@link NumberFormat}æˆ–è€…è‡ªå®šä¹‰æ³¨è§£</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;3. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void converterWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;converterWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, ConverterData.class).sheet(&quot;æ¨¡æ¿&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="å›¾ç‰‡å¯¼å‡º">å›¾ç‰‡å¯¼å‡º<a class="hash-link" href="#å›¾ç‰‡å¯¼å‡º" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-6">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-6" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2021/png/553000/1631889109313-0df2831a-06e8-42bb-8eed-94bf4eb154bb.png#clientId=u161a1dee-6811-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=380&amp;id=u7d4f6af1&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=380&amp;originWidth=1044&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=168990&amp;status=done&amp;style=none&amp;taskId=u9de24145-4863-481a-af3e-0bdfe20363d&amp;title=&amp;width=1044" alt="image.png" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-6">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-6" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ContentRowHeight(100)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ColumnWidth(100 / 8)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class ImageDemoData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private File file;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private InputStream inputStream;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * å¦‚æœstringç±»å‹ å¿…é¡»æŒ‡å®šè½¬æ¢å™¨ï¼Œstringé»˜è®¤è½¬æ¢æˆstring</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(converter = StringImageConverter.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private byte[] byteArray;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æ ¹æ®urlå¯¼å‡º</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 2.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private URL url;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æ ¹æ®æ–‡ä»¶å¯¼å‡º å¹¶è®¾ç½®å¯¼å‡ºçš„ä½ç½®ã€‚</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private WriteCellData&lt;Void&gt; writeCellDataFile;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -6">ä»£ç <a class="hash-link" href="#ä»£ç -6" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">   /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * å›¾ç‰‡å¯¼å‡º</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link ImageDemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void imageWrite() throws Exception {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;imageWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String imagePath = TestFileUtil.getPath() + &quot;converter&quot; + File.separator + &quot;img.jpg&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try (InputStream inputStream = FileUtils.openInputStream(new File(imagePath))) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            List&lt;ImageDemoData&gt; list =  ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ImageDemoData imageDemoData = new ImageDemoData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            list.add(imageDemoData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // æ”¾å…¥äº”ç§ç±»å‹çš„å›¾ç‰‡ å®é™…ä½¿ç”¨åªè¦é€‰ä¸€ç§å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDemoData.setByteArray(FileUtils.readFileToByteArray(new File(imagePath)));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDemoData.setFile(new File(imagePath));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDemoData.setString(imagePath);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDemoData.setInputStream(inputStream);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDemoData.setUrl(new URL(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                &quot;https://raw.githubusercontent.com/alibaba/easyexcel/master/src/test/resources/converter/img.jpg&quot;));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¿™é‡Œæ¼”ç¤º</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // éœ€è¦é¢å¤–æ”¾å…¥æ–‡å­—</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è€Œä¸”éœ€è¦æ”¾å…¥2ä¸ªå›¾ç‰‡</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // ç¬¬ä¸€ä¸ªå›¾ç‰‡é å·¦</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // ç¬¬äºŒä¸ªé å³ è€Œä¸”è¦é¢å¤–çš„å ç”¨ä»–åé¢çš„å•å…ƒæ ¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WriteCellData&lt;Void&gt; writeCellData = new WriteCellData&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDemoData.setWriteCellDataFile(writeCellData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¿™é‡Œå¯ä»¥è®¾ç½®ä¸º EMPTY åˆ™ä»£è¡¨ä¸éœ€è¦å…¶ä»–æ•°æ®äº†</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            writeCellData.setType(CellDataTypeEnum.STRING);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            writeCellData.setStringValue(&quot;é¢å¤–çš„æ”¾ä¸€äº›æ–‡å­—&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // å¯ä»¥æ”¾å…¥å¤šä¸ªå›¾ç‰‡</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            List&lt;ImageData&gt; imageDataList = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            ImageData imageData = new ImageData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDataList.add(imageData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            writeCellData.setImageDataList(imageDataList);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // æ”¾å…¥2è¿›åˆ¶å›¾ç‰‡</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setImage(FileUtils.readFileToByteArray(new File(imagePath)));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // å›¾ç‰‡ç±»å‹</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setImageType(ImageType.PICTURE_TYPE_PNG);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // ä¸Š å³ ä¸‹ å·¦ éœ€è¦ç•™ç©º</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¿™ä¸ªç±»ä¼¼äº css çš„ margin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¿™é‡Œå®æµ‹ ä¸èƒ½è®¾ç½®å¤ªå¤§ è¶…è¿‡å•å…ƒæ ¼åŸå§‹å¤§å°å æ‰“å¼€ä¼šæç¤ºä¿®å¤ã€‚æš‚æ—¶æœªæ‰¾åˆ°å¾ˆå¥½çš„è§£æ³•ã€‚</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setTop(5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setRight(40);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setBottom(5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setLeft(5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // æ”¾å…¥ç¬¬äºŒä¸ªå›¾ç‰‡</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData = new ImageData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageDataList.add(imageData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            writeCellData.setImageDataList(imageDataList);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setImage(FileUtils.readFileToByteArray(new File(imagePath)));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setImageType(ImageType.PICTURE_TYPE_PNG);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setTop(5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setRight(5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setBottom(5);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setLeft(50);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è®¾ç½®å›¾ç‰‡çš„ä½ç½® å‡è®¾ ç°åœ¨ç›®æ ‡ æ˜¯ è¦†ç›– å½“å‰å•å…ƒæ ¼ å’Œå½“å‰å•å…ƒæ ¼å³è¾¹çš„å•å…ƒæ ¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // èµ·ç‚¹ç›¸å¯¹äºå½“å‰å•å…ƒæ ¼ä¸º0 å½“ç„¶å¯ä»¥ä¸å†™</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setRelativeFirstRowIndex(0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setRelativeFirstColumnIndex(0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setRelativeLastRowIndex(0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // å‰é¢3ä¸ªå¯ä»¥ä¸å†™  ä¸‹é¢è¿™ä¸ªéœ€è¦å†™ ä¹Ÿå°±æ˜¯ ç»“å°¾ éœ€è¦ç›¸å¯¹å½“å‰å•å…ƒæ ¼ å¾€å³ç§»åŠ¨ä¸€æ ¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // ä¹Ÿå°±æ˜¯è¯´ è¿™ä¸ªå›¾ç‰‡ä¼šè¦†ç›–å½“å‰å•å…ƒæ ¼å’Œ åé¢çš„é‚£ä¸€æ ¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            imageData.setRelativeLastColumnIndex(1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // å†™å…¥æ•°æ®</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            EasyExcel.write(fileName, ImageDemoData.class).sheet().doWrite(list);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="è¶…é“¾æ¥å¤‡æ³¨å…¬å¼æŒ‡å®šå•ä¸ªå•å…ƒæ ¼çš„æ ·å¼å•ä¸ªå•å…ƒæ ¼å¤šç§æ ·å¼">è¶…é“¾æ¥ã€å¤‡æ³¨ã€å…¬å¼ã€æŒ‡å®šå•ä¸ªå•å…ƒæ ¼çš„æ ·å¼ã€å•ä¸ªå•å…ƒæ ¼å¤šç§æ ·å¼<a class="hash-link" href="#è¶…é“¾æ¥å¤‡æ³¨å…¬å¼æŒ‡å®šå•ä¸ªå•å…ƒæ ¼çš„æ ·å¼å•ä¸ªå•å…ƒæ ¼å¤šç§æ ·å¼" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-7">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-7" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2021/png/553000/1632399587137-5177a60c-8b76-4611-be5c-1aa48705e23d.png#clientId=u3934b511-aee8-4&amp;crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;from=paste&amp;height=210&amp;id=u7c5a97bc&amp;margin=%5Bobject%20Object%5D&amp;name=image.png&amp;originHeight=210&amp;originWidth=614&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=80843&amp;status=done&amp;style=none&amp;taskId=uc355f071-b03e-4dfd-a3d1-030924922fe&amp;title=&amp;width=614" alt="image.png" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-7">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-7" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class WriteCellDemoData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * è¶…é“¾æ¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private WriteCellData&lt;String&gt; hyperlink;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * å¤‡æ³¨</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private WriteCellData&lt;String&gt; commentData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * å…¬å¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private WriteCellData&lt;String&gt; formulaData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æŒ‡å®šå•å…ƒæ ¼çš„æ ·å¼ã€‚å½“ç„¶æ ·å¼ ä¹Ÿå¯ä»¥ç”¨æ³¨è§£ç­‰æ–¹å¼ã€‚</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private WriteCellData&lt;String&gt; writeCellStyle;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æŒ‡å®šä¸€ä¸ªå•å…ƒæ ¼æœ‰å¤šä¸ªæ ·å¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private WriteCellData&lt;String&gt; richText;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -7">ä»£ç <a class="hash-link" href="#ä»£ç -7" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * è¶…é“¾æ¥ã€å¤‡æ³¨ã€å…¬å¼ã€æŒ‡å®šå•ä¸ªå•å…ƒæ ¼çš„æ ·å¼ã€å•ä¸ªå•å…ƒæ ¼å¤šç§æ ·å¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link WriteCellDemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 3.0.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void writeCellDataWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;writeCellDataWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellDemoData writeCellDemoData = new WriteCellDemoData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è®¾ç½®è¶…é“¾æ¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellData&lt;String&gt; hyperlink = new WriteCellData&lt;&gt;(&quot;å®˜æ–¹ç½‘ç«™&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellDemoData.setHyperlink(hyperlink);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        HyperlinkData hyperlinkData = new HyperlinkData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        hyperlink.setHyperlinkData(hyperlinkData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        hyperlinkData.setAddress(&quot;https://github.com/alibaba/easyexcel&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        hyperlinkData.setHyperlinkType(HyperlinkType.URL);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è®¾ç½®å¤‡æ³¨</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellData&lt;String&gt; comment = new WriteCellData&lt;&gt;(&quot;å¤‡æ³¨çš„å•å…ƒæ ¼ä¿¡æ¯&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellDemoData.setCommentData(comment);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        CommentData commentData = new CommentData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        comment.setCommentData(commentData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        commentData.setAuthor(&quot;Jiaju Zhuang&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        commentData.setRichTextStringData(new RichTextStringData(&quot;è¿™æ˜¯ä¸€ä¸ªå¤‡æ³¨&quot;));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å¤‡æ³¨çš„é»˜è®¤å¤§å°æ˜¯æŒ‰ç…§å•å…ƒæ ¼çš„å¤§å° è¿™é‡Œæƒ³è°ƒæ•´åˆ°4ä¸ªå•å…ƒæ ¼é‚£ä¹ˆå¤§ æ‰€ä»¥å‘å å‘ä¸‹ å„é¢å¤–å ç”¨äº†ä¸€ä¸ªå•å…ƒæ ¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        commentData.setRelativeLastColumnIndex(1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        commentData.setRelativeLastRowIndex(1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è®¾ç½®å…¬å¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellData&lt;String&gt; formula = new WriteCellData&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellDemoData.setFormulaData(formula);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        FormulaData formulaData = new FormulaData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        formula.setFormulaData(formulaData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å°† 123456789 ä¸­çš„ç¬¬ä¸€ä¸ªæ•°å­—æ›¿æ¢æˆ 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œåªæ˜¯ä¾‹å­ å¦‚æœçœŸçš„æ¶‰åŠåˆ°å…¬å¼ èƒ½å†…å­˜ç®—å¥½å°½é‡å†…å­˜ç®—å¥½ å…¬å¼èƒ½ä¸ç”¨å°½é‡ä¸ç”¨</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        formulaData.setFormulaValue(&quot;REPLACE(123456789,1,1,2)&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è®¾ç½®å•ä¸ªå•å…ƒæ ¼çš„æ ·å¼ å½“ç„¶æ ·å¼ å¾ˆå¤šçš„è¯ ä¹Ÿå¯ä»¥ç”¨æ³¨è§£ç­‰æ–¹å¼ã€‚</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellData&lt;String&gt; writeCellStyle = new WriteCellData&lt;&gt;(&quot;å•å…ƒæ ¼æ ·å¼&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellStyle.setType(CellDataTypeEnum.STRING);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellDemoData.setWriteCellStyle(writeCellStyle);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellStyle writeCellStyleData = new WriteCellStyle();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellStyle.setWriteCellStyle(writeCellStyleData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œéœ€è¦æŒ‡å®š FillPatternType ä¸ºFillPatternType.SOLID_FOREGROUND ä¸ç„¶æ— æ³•æ˜¾ç¤ºèƒŒæ™¯é¢œè‰².</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellStyleData.setFillPatternType(FillPatternType.SOLID_FOREGROUND);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // èƒŒæ™¯ç»¿è‰²</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellStyleData.setFillForegroundColor(IndexedColors.GREEN.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è®¾ç½®å•ä¸ªå•å…ƒæ ¼å¤šç§æ ·å¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellData&lt;String&gt; richTest = new WriteCellData&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        richTest.setType(CellDataTypeEnum.RICH_TEXT_STRING);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeCellDemoData.setRichText(richTest);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        RichTextStringData richTextStringData = new RichTextStringData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        richTest.setRichTextStringDataValue(richTextStringData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        richTextStringData.setTextString(&quot;çº¢è‰²ç»¿è‰²é»˜è®¤&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å‰2ä¸ªå­—çº¢è‰²</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteFont writeFont = new WriteFont();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeFont.setColor(IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        richTextStringData.applyFont(0, 2, writeFont);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ¥ä¸‹æ¥2ä¸ªå­—ç»¿è‰²</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeFont = new WriteFont();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        writeFont.setColor(IndexedColors.GREEN.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        richTextStringData.applyFont(2, 4, writeFont);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;WriteCellDemoData&gt; data = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        data.add(writeCellDemoData);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, WriteCellDemoData.class).inMemory(true).sheet(&quot;æ¨¡æ¿&quot;).doWrite(data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="æ ¹æ®æ¨¡æ¿å†™å…¥">æ ¹æ®æ¨¡æ¿å†™å…¥<a class="hash-link" href="#æ ¹æ®æ¨¡æ¿å†™å…¥" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="æ¨¡æ¿excelç¤ºä¾‹">æ¨¡æ¿excelç¤ºä¾‹<a class="hash-link" href="#æ¨¡æ¿excelç¤ºä¾‹" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454122686-9d2057e0-7063-4e2d-b6ae-5effb7464144.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=229&amp;id=OYUkZ&amp;originHeight=229&amp;originWidth=332&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=332" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-8">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-8" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454129904-8955f8f4-22a4-4b7d-9a30-057c3f308305.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=478&amp;id=ohNYU&amp;originHeight=478&amp;originWidth=344&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=344" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-8">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-8" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>å‚ç…§ï¼š<a href="#5bd247f4">å¯¹è±¡</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -8">ä»£ç <a class="hash-link" href="#ä»£ç -8" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æ ¹æ®æ¨¡æ¿å†™å…¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link IndexData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;2. ä½¿ç”¨{@link ExcelProperty}æ³¨è§£æŒ‡å®šå†™å…¥çš„åˆ—</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;3. ä½¿ç”¨withTemplate å†™å–æ¨¡æ¿</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;4. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void templateWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String templateFileName = TestFileUtil.getPath() + &quot;demo&quot; + File.separator + &quot;demo.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;templateWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).withTemplate(templateFileName).sheet().doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="åˆ—å®½è¡Œé«˜">åˆ—å®½ã€è¡Œé«˜<a class="hash-link" href="#åˆ—å®½è¡Œé«˜" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-9">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-9" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454147594-9473d4f6-f068-4f83-b403-474ef51f3cad.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=208&amp;id=VLodr&amp;originHeight=208&amp;originWidth=854&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=854" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-9">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-9" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ContentRowHeight(10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@HeadRowHeight(20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ColumnWidth(25)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class WidthAndHeightData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * å®½åº¦ä¸º50</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ColumnWidth(50)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ•°å­—æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -9">ä»£ç <a class="hash-link" href="#ä»£ç -9" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * åˆ—å®½ã€è¡Œé«˜</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link WidthAndHeightData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;2. ä½¿ç”¨æ³¨è§£{@link ColumnWidth}ã€{@link HeadRowHeight}ã€{@link ContentRowHeight}æŒ‡å®šå®½åº¦æˆ–é«˜åº¦</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;3. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void widthAndHeightWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;widthAndHeightWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, WidthAndHeightData.class).sheet(&quot;æ¨¡æ¿&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="æ³¨è§£å½¢å¼è‡ªå®šä¹‰æ ·å¼">æ³¨è§£å½¢å¼è‡ªå®šä¹‰æ ·å¼<a class="hash-link" href="#æ³¨è§£å½¢å¼è‡ªå®šä¹‰æ ·å¼" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="since">since<a class="hash-link" href="#since" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>2.2.0-beta1</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-10">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-10" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584459931145-96d4f61c-5a64-4dd0-b174-157e58c680bb.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=824&amp;id=YRC2m&amp;name=image.png&amp;originHeight=824&amp;originWidth=269&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=39533&amp;status=done&amp;style=none&amp;title=&amp;width=269" alt="image.png" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-10">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-10" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// å¤´èƒŒæ™¯è®¾ç½®æˆçº¢è‰² IndexedColors.RED.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// å¤´å­—ä½“è®¾ç½®æˆ20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@HeadFontStyle(fontHeightInPoints = 20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// å†…å®¹çš„èƒŒæ™¯è®¾ç½®æˆç»¿è‰² IndexedColors.GREEN.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ContentStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 17)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// å†…å®¹å­—ä½“è®¾ç½®æˆ20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ContentFontStyle(fontHeightInPoints = 20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class DemoStyleData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // å­—ç¬¦ä¸²çš„å¤´èƒŒæ™¯è®¾ç½®æˆç²‰çº¢ IndexedColors.PINK.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @HeadStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 14)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // å­—ç¬¦ä¸²çš„å¤´å­—ä½“è®¾ç½®æˆ20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @HeadFontStyle(fontHeightInPoints = 30)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // å­—ç¬¦ä¸²çš„å†…å®¹çš„èƒŒæ™¯è®¾ç½®æˆå¤©è“ IndexedColors.SKY_BLUE.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ContentStyle(fillPatternType = FillPatternTypeEnum.SOLID_FOREGROUND, fillForegroundColor = 40)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // å­—ç¬¦ä¸²çš„å†…å®¹å­—ä½“è®¾ç½®æˆ20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ContentFontStyle(fontHeightInPoints = 30)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ•°å­—æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * æ ·å¼çš„æ•°æ®ç±»</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @author Jiaju Zhuang</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> **/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// å¤´èƒŒæ™¯è®¾ç½®æˆçº¢è‰² IndexedColors.RED.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@HeadStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// å¤´å­—ä½“è®¾ç½®æˆ20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@HeadFontStyle(fontHeightInPoints = 20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// å†…å®¹çš„èƒŒæ™¯è®¾ç½®æˆç»¿è‰² IndexedColors.GREEN.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ContentStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 17)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// å†…å®¹å­—ä½“è®¾ç½®æˆ20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@ContentFontStyle(fontHeightInPoints = 20)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class DemoStyleData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // å­—ç¬¦ä¸²çš„å¤´èƒŒæ™¯è®¾ç½®æˆç²‰çº¢ IndexedColors.PINK.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @HeadStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 14)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // å­—ç¬¦ä¸²çš„å¤´å­—ä½“è®¾ç½®æˆ20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @HeadFontStyle(fontHeightInPoints = 30)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // å­—ç¬¦ä¸²çš„å†…å®¹çš„èƒŒæ™¯è®¾ç½®æˆå¤©è“ IndexedColors.SKY_BLUE.getIndex()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ContentStyle(fillPatternType = FillPatternType.SOLID_FOREGROUND, fillForegroundColor = 40)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // å­—ç¬¦ä¸²çš„å†…å®¹å­—ä½“è®¾ç½®æˆ20</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ContentFontStyle(fontHeightInPoints = 30)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ•°å­—æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -10">ä»£ç <a class="hash-link" href="#ä»£ç -10" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æ³¨è§£å½¢å¼è‡ªå®šä¹‰æ ·å¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link DemoStyleData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 2.2.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void annotationStyleWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;annotationStyleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoStyleData.class).sheet(&quot;æ¨¡æ¿&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="è‡ªå®šä¹‰æ ·å¼">è‡ªå®šä¹‰æ ·å¼<a class="hash-link" href="#è‡ªå®šä¹‰æ ·å¼" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-11">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-11" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454162913-76aed75e-9b02-4b7d-88a0-05c336133f8b.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=497&amp;id=QZECN&amp;originHeight=497&amp;originWidth=270&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=270" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-11">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-11" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>å‚ç…§ï¼š<a href="#5bd247f4">å¯¹è±¡</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -11">ä»£ç <a class="hash-link" href="#ä»£ç -11" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æ‹¦æˆªå™¨å½¢å¼è‡ªå®šä¹‰æ ·å¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. åˆ›å»ºä¸€ä¸ªstyleç­–ç•¥ å¹¶æ³¨å†Œ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void handlerStyleWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ–¹æ³•1 ä½¿ç”¨å·²æœ‰çš„ç­–ç•¥ æ¨è</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // HorizontalCellStyleStrategy æ¯ä¸€è¡Œçš„æ ·å¼éƒ½ä¸€æ · æˆ–è€…éš”è¡Œä¸€æ ·</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // AbstractVerticalCellStyleStrategy æ¯ä¸€åˆ—çš„æ ·å¼éƒ½ä¸€æ · éœ€è¦è‡ªå·±å›è°ƒæ¯ä¸€é¡µ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;handlerStyleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å¤´çš„ç­–ç•¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellStyle headWriteCellStyle = new WriteCellStyle();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // èƒŒæ™¯è®¾ç½®ä¸ºçº¢è‰²</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        headWriteCellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteFont headWriteFont = new WriteFont();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        headWriteFont.setFontHeightInPoints((short)20);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        headWriteCellStyle.setWriteFont(headWriteFont);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å†…å®¹çš„ç­–ç•¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteCellStyle contentWriteCellStyle = new WriteCellStyle();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œéœ€è¦æŒ‡å®š FillPatternType ä¸ºFillPatternType.SOLID_FOREGROUND ä¸ç„¶æ— æ³•æ˜¾ç¤ºèƒŒæ™¯é¢œè‰².å¤´é»˜è®¤äº† FillPatternTypeæ‰€ä»¥å¯ä»¥ä¸æŒ‡å®š</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        contentWriteCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // èƒŒæ™¯ç»¿è‰²</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        contentWriteCellStyle.setFillForegroundColor(IndexedColors.GREEN.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        WriteFont contentWriteFont = new WriteFont();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å­—ä½“å¤§å°</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        contentWriteFont.setFontHeightInPoints((short)20);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        contentWriteCellStyle.setWriteFont(contentWriteFont);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™ä¸ªç­–ç•¥æ˜¯ å¤´æ˜¯å¤´çš„æ ·å¼ å†…å®¹æ˜¯å†…å®¹çš„æ ·å¼ å…¶ä»–çš„ç­–ç•¥å¯ä»¥è‡ªå·±å®ç°</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        HorizontalCellStyleStrategy horizontalCellStyleStrategy =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            new HorizontalCellStyleStrategy(headWriteCellStyle, contentWriteCellStyle);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .registerWriteHandler(horizontalCellStyleStrategy)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .sheet(&quot;æ¨¡æ¿&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ–¹æ³•2: ä½¿ç”¨easyexcelçš„æ–¹å¼å®Œå…¨è‡ªå·±å†™ ä¸å¤ªæ¨è å°½é‡ä½¿ç”¨å·²æœ‰ç­–ç•¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // @since 3.0.0-beta2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;handlerStyleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .registerWriteHandler(new CellWriteHandler() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                public void afterCellDispose(CellWriteHandlerContext context) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    // å½“å‰äº‹ä»¶ä¼šåœ¨ æ•°æ®è®¾ç½®åˆ°poiçš„cellé‡Œé¢æ‰ä¼šå›è°ƒ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    // åˆ¤æ–­ä¸æ˜¯å¤´çš„æƒ…å†µ å¦‚æœæ˜¯fill çš„æƒ…å†µ è¿™é‡Œä¼š==null æ‰€ä»¥ç”¨not true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    if (BooleanUtils.isNotTrue(context.getHead())) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // ç¬¬ä¸€ä¸ªå•å…ƒæ ¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // åªè¦ä¸æ˜¯å¤´ ä¸€å®šä¼šæœ‰æ•°æ® å½“ç„¶fillçš„æƒ…å†µ å¯èƒ½è¦context.getCellDataList() ,è¿™ä¸ªéœ€è¦çœ‹æ¨¡æ¿ï¼Œå› ä¸ºä¸€ä¸ªå•å…ƒæ ¼ä¼šæœ‰å¤šä¸ª WriteCellData</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        WriteCellData&lt;?&gt; cellData = context.getFirstCellData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // è¿™é‡Œéœ€è¦å»cellData è·å–æ ·å¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // å¾ˆé‡è¦çš„ä¸€ä¸ªåŸå› æ˜¯ WriteCellStyle å’Œ dataFormatDataç»‘å®šçš„ ç®€å•çš„è¯´ æ¯”å¦‚ä½ åŠ äº† DateTimeFormat</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // ï¼Œå·²ç»å°†writeCellStyleé‡Œé¢çš„dataFormatData æ”¹äº† å¦‚æœä½ è‡ªå·±newäº†ä¸€ä¸ªWriteCellStyleï¼Œå¯èƒ½æ³¨è§£çš„æ ·å¼å°±å¤±æ•ˆäº†</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // ç„¶å getOrCreateStyle ç”¨äºè¿”å›ä¸€ä¸ªæ ·å¼ï¼Œå¦‚æœä¸ºç©ºï¼Œåˆ™åˆ›å»ºä¸€ä¸ªåè¿”å›</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        WriteCellStyle writeCellStyle = cellData.getOrCreateStyle();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        writeCellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // è¿™é‡Œéœ€è¦æŒ‡å®š FillPatternType ä¸ºFillPatternType.SOLID_FOREGROUND</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        writeCellStyle.setFillPatternType(FillPatternType.SOLID_FOREGROUND);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // è¿™æ ·æ ·å¼å°±è®¾ç½®å¥½äº† åé¢æœ‰ä¸ªFillStyleCellWriteHandler é»˜è®¤ä¼šå°† WriteCellStyle è®¾ç½®åˆ° cellé‡Œé¢å» æ‰€ä»¥å¯ä»¥ä¸ç”¨ç®¡äº†</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }).sheet(&quot;æ¨¡æ¿&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ–¹æ³•3: ä½¿ç”¨poiçš„æ ·å¼å®Œå…¨è‡ªå·±å†™ ä¸æ¨è</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // @since 3.0.0-beta2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å‘1ï¼šstyleé‡Œé¢æœ‰dataformat ç”¨æ¥æ ¼å¼åŒ–æ•°æ®çš„ æ‰€ä»¥è‡ªå·±è®¾ç½®å¯èƒ½å¯¼è‡´æ ¼å¼åŒ–æ³¨è§£ä¸ç”Ÿæ•ˆ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å‘2ï¼šä¸è¦ä¸€ç›´å»åˆ›å»ºstyle è®°å¾—ç¼“å­˜èµ·æ¥ æœ€å¤šåˆ›å»º6Wä¸ªå°±æŒ‚äº†</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;handlerStyleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .registerWriteHandler(new CellWriteHandler() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                public void afterCellDispose(CellWriteHandlerContext context) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    // å½“å‰äº‹ä»¶ä¼šåœ¨ æ•°æ®è®¾ç½®åˆ°poiçš„cellé‡Œé¢æ‰ä¼šå›è°ƒ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    // åˆ¤æ–­ä¸æ˜¯å¤´çš„æƒ…å†µ å¦‚æœæ˜¯fill çš„æƒ…å†µ è¿™é‡Œä¼š==null æ‰€ä»¥ç”¨not true</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    if (BooleanUtils.isNotTrue(context.getHead())) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        Cell cell = context.getCell();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // æ‹¿åˆ°poiçš„workbook</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        Workbook workbook = context.getWriteWorkbookHolder().getWorkbook();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // è¿™é‡Œåƒä¸‡è®°ä½ æƒ³åŠæ³•èƒ½å¤ç”¨çš„åœ°æ–¹æŠŠä»–ç¼“å­˜èµ·æ¥ ä¸€ä¸ªè¡¨æ ¼æœ€å¤šåˆ›å»º6Wä¸ªæ ·å¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // ä¸åŒå•å…ƒæ ¼å°½é‡ä¼ åŒä¸€ä¸ª cellStyle</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        CellStyle cellStyle = workbook.createCellStyle();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        cellStyle.setFillForegroundColor(IndexedColors.RED.getIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // è¿™é‡Œéœ€è¦æŒ‡å®š FillPatternType ä¸ºFillPatternType.SOLID_FOREGROUND</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        cellStyle.setFillPattern(FillPatternType.SOLID_FOREGROUND);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        cell.setCellStyle(cellStyle);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // ç”±äºè¿™é‡Œæ²¡æœ‰æŒ‡å®šdataformat æœ€åå±•ç¤ºçš„æ•°æ® æ ¼å¼å¯èƒ½ä¼šä¸å¤ªæ­£ç¡®</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // è¿™é‡Œè¦æŠŠ WriteCellDataçš„æ ·å¼æ¸…ç©ºï¼Œ ä¸ç„¶åé¢è¿˜æœ‰ä¸€ä¸ªæ‹¦æˆªå™¨ FillStyleCellWriteHandler é»˜è®¤ä¼šå°† WriteCellStyle è®¾ç½®åˆ°</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        // cellé‡Œé¢å» ä¼šå¯¼è‡´è‡ªå·±è®¾ç½®çš„ä¸ä¸€æ ·</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                        context.getFirstCellData().setWriteCellStyle(null);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }).sheet(&quot;æ¨¡æ¿&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="åˆå¹¶å•å…ƒæ ¼">åˆå¹¶å•å…ƒæ ¼<a class="hash-link" href="#åˆå¹¶å•å…ƒæ ¼" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="since-1">since<a class="hash-link" href="#since-1" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>2.2.0-beta1</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-12">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-12" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454178739-0ad9c4c9-f473-44db-8436-64d8265c88c4.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=272&amp;id=uvyR7&amp;originHeight=272&amp;originWidth=291&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=291" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-12">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-12" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>æ–¹æ³•1</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// å°†ç¬¬6-7è¡Œçš„2-3åˆ—åˆå¹¶æˆä¸€ä¸ªå•å…ƒæ ¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">// @OnceAbsoluteMerge(firstRowIndex = 5, lastRowIndex = 6, firstColumnIndex = 1, lastColumnIndex = 2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class DemoMergeData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    // è¿™ä¸€åˆ— æ¯éš”2è¡Œ åˆå¹¶å•å…ƒæ ¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ContentLoopMerge(eachRow = 2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ•°å­—æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>æ–¹æ³•2å‚ç…§ï¼š<a href="#5bd247f4">å¯¹è±¡</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -12">ä»£ç <a class="hash-link" href="#ä»£ç -12" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">   /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * åˆå¹¶å•å…ƒæ ¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link DemoData} {@link DemoMergeData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. åˆ›å»ºä¸€ä¸ªmergeç­–ç•¥ å¹¶æ³¨å†Œ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 2.2.0-beta1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void mergeWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ–¹æ³•1 æ³¨è§£</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;mergeWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // åœ¨DemoStyleDataé‡Œé¢åŠ ä¸ŠContentLoopMergeæ³¨è§£</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoMergeData.class).sheet(&quot;æ¨¡æ¿&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ–¹æ³•2 è‡ªå®šä¹‰åˆå¹¶å•å…ƒæ ¼ç­–ç•¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        fileName = TestFileUtil.getPath() + &quot;mergeWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // æ¯éš”2è¡Œä¼šåˆå¹¶ æŠŠeachColumn è®¾ç½®æˆ 3 ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ•°æ®çš„é•¿åº¦ï¼Œæ‰€ä»¥å°±ç¬¬ä¸€åˆ—ä¼šåˆå¹¶ã€‚å½“ç„¶å…¶ä»–åˆå¹¶ç­–ç•¥ä¹Ÿå¯ä»¥è‡ªå·±å†™</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        LoopMergeStrategy loopMergeStrategy = new LoopMergeStrategy(2, 0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).registerWriteHandler(loopMergeStrategy).sheet(&quot;æ¨¡æ¿&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="ä½¿ç”¨tableå»å†™å…¥">ä½¿ç”¨tableå»å†™å…¥<a class="hash-link" href="#ä½¿ç”¨tableå»å†™å…¥" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-13">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-13" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454202085-e802591b-6e35-4848-b28b-8ebd72e357c6.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=496&amp;id=FW1a7&amp;originHeight=496&amp;originWidth=291&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=291" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-13">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-13" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>å‚ç…§ï¼š<a href="#5bd247f4">å¯¹è±¡</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -13">ä»£ç <a class="hash-link" href="#ä»£ç -13" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">   /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * ä½¿ç”¨tableå»å†™å…¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;2. ç„¶åå†™å…¥tableå³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void tableWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;tableWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œç›´æ¥å†™å¤šä¸ªtableçš„æ¡ˆä¾‹äº†ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ª ä¹Ÿå¯ä»¥ç›´ä¸€è¡Œä»£ç æå®šï¼Œå‚ç…§å…¶ä»–æ¡ˆä¾‹</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        ExcelWriter excelWriter = null;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter = EasyExcel.write(fileName, DemoData.class).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // æŠŠsheetè®¾ç½®ä¸ºä¸éœ€è¦å¤´ ä¸ç„¶ä¼šè¾“å‡ºsheetçš„å¤´ è¿™æ ·çœ‹èµ·æ¥ç¬¬ä¸€ä¸ªtable å°±æœ‰2ä¸ªå¤´äº†</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WriteSheet writeSheet = EasyExcel.writerSheet(&quot;æ¨¡æ¿&quot;).needHead(Boolean.FALSE).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¿™é‡Œå¿…é¡»æŒ‡å®šéœ€è¦å¤´ï¼Œtable ä¼šç»§æ‰¿sheetçš„é…ç½®ï¼Œsheeté…ç½®äº†ä¸éœ€è¦ï¼Œtable é»˜è®¤ä¹Ÿæ˜¯ä¸éœ€è¦</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WriteTable writeTable0 = EasyExcel.writerTable(0).needHead(Boolean.TRUE).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            WriteTable writeTable1 = EasyExcel.writerTable(1).needHead(Boolean.TRUE).build();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // ç¬¬ä¸€æ¬¡å†™å…¥ä¼šåˆ›å»ºå¤´</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter.write(data(), writeSheet, writeTable0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // ç¬¬äºŒæ¬¡å†™å¦‚ä¹Ÿä¼šåˆ›å»ºå¤´ï¼Œç„¶ååœ¨ç¬¬ä¸€æ¬¡çš„åé¢å†™å…¥æ•°æ®</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            excelWriter.write(data(), writeSheet, writeTable1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } finally {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // åƒä¸‡åˆ«å¿˜è®°finish ä¼šå¸®å¿™å…³é—­æµ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            if (excelWriter != null) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                excelWriter.finish();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="åŠ¨æ€å¤´å®æ—¶ç”Ÿæˆå¤´å†™å…¥">åŠ¨æ€å¤´ï¼Œå®æ—¶ç”Ÿæˆå¤´å†™å…¥<a class="hash-link" href="#åŠ¨æ€å¤´å®æ—¶ç”Ÿæˆå¤´å†™å…¥" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-14">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-14" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454219952-d6ffd08d-71fc-4336-83ac-6cd468938ee5.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=334&amp;id=j5tp5&amp;originHeight=334&amp;originWidth=288&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=288" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-14">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-14" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>å‚ç…§ï¼š<a href="#5bd247f4">å¯¹è±¡</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -14">ä»£ç <a class="hash-link" href="#ä»£ç -14" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * åŠ¨æ€å¤´ï¼Œå®æ—¶ç”Ÿæˆå¤´å†™å…¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æ€è·¯æ˜¯è¿™æ ·å­çš„ï¼Œå…ˆåˆ›å»ºList&lt;String&gt;å¤´æ ¼å¼çš„sheetä»…ä»…å†™å…¥å¤´,ç„¶åé€šè¿‡table ä¸å†™å…¥å¤´çš„æ–¹å¼ å»å†™å…¥æ•°æ®</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. ç„¶åå†™å…¥tableå³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void dynamicHeadWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;dynamicHeadWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¿™é‡Œæ”¾å…¥åŠ¨æ€å¤´</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .head(head()).sheet(&quot;æ¨¡æ¿&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // å½“ç„¶è¿™é‡Œæ•°æ®ä¹Ÿå¯ä»¥ç”¨ List&lt;List&lt;String&gt;&gt; å»ä¼ å…¥</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private List&lt;List&lt;String&gt;&gt; head() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;List&lt;String&gt;&gt; list = new ArrayList&lt;List&lt;String&gt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head0 = new ArrayList&lt;String&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head0.add(&quot;å­—ç¬¦ä¸²&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head1 = new ArrayList&lt;String&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head1.add(&quot;æ•°å­—&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head2 = new ArrayList&lt;String&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head2.add(&quot;æ—¥æœŸ&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head2);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="è‡ªåŠ¨åˆ—å®½ä¸å¤ªç²¾ç¡®">è‡ªåŠ¨åˆ—å®½(ä¸å¤ªç²¾ç¡®)<a class="hash-link" href="#è‡ªåŠ¨åˆ—å®½ä¸å¤ªç²¾ç¡®" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-15">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-15" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454254679-c2dc3148-2c31-4849-9d4d-0fc9a5791ad0.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=274&amp;id=lC4lH&amp;originHeight=274&amp;originWidth=1154&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=1154" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-15">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-15" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class LongestMatchColumnWidthData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜å¾ˆé•¿æ—¥æœŸæ ‡é¢˜å¾ˆé•¿æ—¥æœŸæ ‡é¢˜å¾ˆé•¿å¾ˆé•¿&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ•°å­—&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -15">ä»£ç <a class="hash-link" href="#ä»£ç -15" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">   /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * è‡ªåŠ¨åˆ—å®½(ä¸å¤ªç²¾ç¡®)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * è¿™ä¸ªç›®å‰ä¸æ˜¯å¾ˆå¥½ç”¨ï¼Œæ¯”å¦‚æœ‰æ•°å­—å°±ä¼šå¯¼è‡´æ¢è¡Œã€‚è€Œä¸”é•¿åº¦ä¹Ÿä¸æ˜¯åˆšå¥½å’Œå®é™…é•¿åº¦ä¸€è‡´ã€‚ æ‰€ä»¥éœ€è¦ç²¾ç¡®åˆ°åˆšå¥½åˆ—å®½çš„æ…ç”¨ã€‚ å½“ç„¶ä¹Ÿå¯ä»¥è‡ªå·±å‚ç…§</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * {@link LongestMatchColumnWidthStyleStrategy}é‡æ–°å®ç°.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * poi è‡ªå¸¦{@link SXSSFSheet#autoSizeColumn(int)} å¯¹ä¸­æ–‡æ”¯æŒä¹Ÿä¸å¤ªå¥½ã€‚ç›®å‰æ²¡æ‰¾åˆ°å¾ˆå¥½çš„ç®—æ³•ã€‚ æœ‰çš„è¯å¯ä»¥æ¨èä¸‹ã€‚</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link LongestMatchColumnWidthData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. æ³¨å†Œç­–ç•¥{@link LongestMatchColumnWidthStyleStrategy}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void longestMatchColumnWidthWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            TestFileUtil.getPath() + &quot;longestMatchColumnWidthWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, LongestMatchColumnWidthData.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .registerWriteHandler(new LongestMatchColumnWidthStyleStrategy()).sheet(&quot;æ¨¡æ¿&quot;).doWrite(dataLong());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private List&lt;LongestMatchColumnWidthData&gt; dataLong() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;LongestMatchColumnWidthData&gt; list = new ArrayList&lt;LongestMatchColumnWidthData&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        for (int i = 0; i &lt; 10; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            LongestMatchColumnWidthData data = new LongestMatchColumnWidthData();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.setString(&quot;æµ‹è¯•å¾ˆé•¿çš„å­—ç¬¦ä¸²æµ‹è¯•å¾ˆé•¿çš„å­—ç¬¦ä¸²æµ‹è¯•å¾ˆé•¿çš„å­—ç¬¦ä¸²&quot; + i);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.setDate(new Date());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.setDoubleData(1000000000000.0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            list.add(data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="è‡ªå®šä¹‰æ‹¦æˆªå™¨ä¸Šé¢å‡ ç‚¹éƒ½ä¸ç¬¦åˆä½†æ˜¯è¦å¯¹å•å…ƒæ ¼è¿›è¡Œæ“ä½œçš„å‚ç…§è¿™ä¸ª">è‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼ˆä¸Šé¢å‡ ç‚¹éƒ½ä¸ç¬¦åˆä½†æ˜¯è¦å¯¹å•å…ƒæ ¼è¿›è¡Œæ“ä½œçš„å‚ç…§è¿™ä¸ªï¼‰<a class="hash-link" href="#è‡ªå®šä¹‰æ‹¦æˆªå™¨ä¸Šé¢å‡ ç‚¹éƒ½ä¸ç¬¦åˆä½†æ˜¯è¦å¯¹å•å…ƒæ ¼è¿›è¡Œæ“ä½œçš„å‚ç…§è¿™ä¸ª" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-16">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-16" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454252320-bdd06be9-8f58-47fa-915f-c64f07765837.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=259&amp;id=R2VQ7&amp;originHeight=259&amp;originWidth=259&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=259" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-16">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-16" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>å‚ç…§ï¼š<a href="#5bd247f4">å¯¹è±¡</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å®šä¹‰æ‹¦æˆªå™¨">å®šä¹‰æ‹¦æˆªå™¨<a class="hash-link" href="#å®šä¹‰æ‹¦æˆªå™¨" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * è‡ªå®šä¹‰æ‹¦æˆªå™¨ã€‚å¯¹ç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—çš„å¤´è¶…é“¾æ¥åˆ°:https://github.com/alibaba/easyexcel</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @author Jiaju Zhuang</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class CustomCellWriteHandler implements CellWriteHandler {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void afterCellDispose(CellWriteHandlerContext context) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Cell cell = context.getCell();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œå¯ä»¥å¯¹cellè¿›è¡Œä»»ä½•æ“ä½œ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        log.info(&quot;ç¬¬{}è¡Œï¼Œç¬¬{}åˆ—å†™å…¥å®Œæˆã€‚&quot;, cell.getRowIndex(), cell.getColumnIndex());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (BooleanUtils.isTrue(context.getHead()) &amp;&amp; cell.getColumnIndex() == 0) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            CreationHelper createHelper = context.getWriteSheetHolder().getSheet().getWorkbook().getCreationHelper();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Hyperlink hyperlink = createHelper.createHyperlink(HyperlinkType.URL);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            hyperlink.setAddress(&quot;https://github.com/alibaba/easyexcel&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            cell.setHyperlink(hyperlink);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * è‡ªå®šä¹‰æ‹¦æˆªå™¨.å¯¹ç¬¬ä¸€åˆ—ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡Œçš„æ•°æ®æ–°å¢ä¸‹æ‹‰æ¡†ï¼Œæ˜¾ç¤º æµ‹è¯•1 æµ‹è¯•2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @author Jiaju Zhuang</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class CustomSheetWriteHandler implements SheetWriteHandler {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void afterSheetCreate(SheetWriteHandlerContext context) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        log.info(&quot;ç¬¬{}ä¸ªSheetå†™å…¥æˆåŠŸã€‚&quot;, context.getWriteSheetHolder().getSheetNo());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // åŒºé—´è®¾ç½® ç¬¬ä¸€åˆ—ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡Œçš„æ•°æ®ã€‚ç”±äºç¬¬ä¸€è¡Œæ˜¯å¤´ï¼Œæ‰€ä»¥ç¬¬ä¸€ã€äºŒè¡Œçš„æ•°æ®å®é™…ä¸Šæ˜¯ç¬¬äºŒä¸‰è¡Œ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        CellRangeAddressList cellRangeAddressList = new CellRangeAddressList(1, 2, 0, 0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        DataValidationHelper helper = context.getWriteSheetHolder().getSheet().getDataValidationHelper();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        DataValidationConstraint constraint = helper.createExplicitListConstraint(new String[] {&quot;æµ‹è¯•1&quot;, &quot;æµ‹è¯•2&quot;});</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        DataValidation dataValidation = helper.createValidation(constraint, cellRangeAddressList);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        context.getWriteSheetHolder().getSheet().addValidationData(dataValidation);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -16">ä»£ç <a class="hash-link" href="#ä»£ç -16" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * ä¸‹æ‹‰ï¼Œè¶…é“¾æ¥ç­‰è‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼ˆä¸Šé¢å‡ ç‚¹éƒ½ä¸ç¬¦åˆä½†æ˜¯è¦å¯¹å•å…ƒæ ¼è¿›è¡Œæ“ä½œçš„å‚ç…§è¿™ä¸ªï¼‰</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * demoè¿™é‡Œå®ç°2ç‚¹ã€‚1. å¯¹ç¬¬ä¸€è¡Œç¬¬ä¸€åˆ—çš„å¤´è¶…é“¾æ¥åˆ°:https://github.com/alibaba/easyexcel 2. å¯¹ç¬¬ä¸€åˆ—ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡Œçš„æ•°æ®æ–°å¢ä¸‹æ‹‰æ¡†ï¼Œæ˜¾ç¤º æµ‹è¯•1 æµ‹è¯•2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. æ³¨å†Œæ‹¦æˆªå™¨ {@link CustomCellWriteHandler} {@link CustomSheetWriteHandler}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void customHandlerWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;customHandlerWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).registerWriteHandler(new CustomSheetWriteHandler())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .registerWriteHandler(new CustomCellWriteHandler()).sheet(&quot;æ¨¡æ¿&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="æ’å…¥æ‰¹æ³¨">æ’å…¥æ‰¹æ³¨<a class="hash-link" href="#æ’å…¥æ‰¹æ³¨" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-17">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-17" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584962388694-b97f68aa-e1b0-4b64-9442-184ad9f97329.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=301&amp;id=r5pMZ&amp;name=image.png&amp;originHeight=301&amp;originWidth=287&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=18159&amp;status=done&amp;style=none&amp;title=&amp;width=287" alt="image.png" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-17">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-17" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>å‚ç…§ï¼š<a href="#5bd247f4">å¯¹è±¡</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å®šä¹‰æ‹¦æˆªå™¨-1">å®šä¹‰æ‹¦æˆªå™¨<a class="hash-link" href="#å®šä¹‰æ‹¦æˆªå™¨-1" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * è‡ªå®šä¹‰æ‹¦æˆªå™¨.æ–°å¢æ³¨é‡Š,ç¬¬ä¸€è¡Œå¤´åŠ æ‰¹æ³¨</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> * @author Jiaju Zhuang</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Slf4j</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class CommentWriteHandler implements RowWriteHandler {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void afterRowDispose(RowWriteHandlerContext context) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        if (BooleanUtils.isTrue(context.getHead())) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Sheet sheet = context.getWriteSheetHolder().getSheet();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Drawing&lt;?&gt; drawingPatriarch = sheet.createDrawingPatriarch();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // åœ¨ç¬¬ä¸€è¡Œ ç¬¬äºŒåˆ—åˆ›å»ºä¸€ä¸ªæ‰¹æ³¨</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Comment comment =</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                drawingPatriarch.createCellComment(new XSSFClientAnchor(0, 0, 0, 0, (short)1, 0, (short)2, 1));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¾“å…¥æ‰¹æ³¨ä¿¡æ¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            comment.setString(new XSSFRichTextString(&quot;åˆ›å»ºæ‰¹æ³¨!&quot;));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // å°†æ‰¹æ³¨æ·»åŠ åˆ°å•å…ƒæ ¼å¯¹è±¡ä¸­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            sheet.getRow(0).getCell(1).setCellComment(comment);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -17">ä»£ç <a class="hash-link" href="#ä»£ç -17" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æ’å…¥æ‰¹æ³¨</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link DemoData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. æ³¨å†Œæ‹¦æˆªå™¨ {@link CommentWriteHandler}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void commentWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;commentWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œè¦æ³¨æ„inMemory è¦è®¾ç½®ä¸ºtrueï¼Œæ‰èƒ½æ”¯æŒæ‰¹æ³¨ã€‚ç›®å‰æ²¡æœ‰å¥½çš„åŠæ³•è§£å†³ ä¸åœ¨å†…å­˜å¤„ç†æ‰¹æ³¨ã€‚è¿™ä¸ªéœ€è¦è‡ªå·±é€‰æ‹©ã€‚</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, DemoData.class).inMemory(Boolean.TRUE).registerWriteHandler(new CommentWriteHandler())</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            .sheet(&quot;æ¨¡æ¿&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="å¯å˜æ ‡é¢˜å¤„ç†åŒ…æ‹¬æ ‡é¢˜å›½é™…åŒ–ç­‰">å¯å˜æ ‡é¢˜å¤„ç†(åŒ…æ‹¬æ ‡é¢˜å›½é™…åŒ–ç­‰)<a class="hash-link" href="#å¯å˜æ ‡é¢˜å¤„ç†åŒ…æ‹¬æ ‡é¢˜å›½é™…åŒ–ç­‰" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-18">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-18" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454289882-fd4a4ba9-a800-4a34-bd66-92061d58c21b.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=245&amp;id=lFwAZ&amp;originHeight=245&amp;originWidth=269&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=269" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-18">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-18" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Getter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Setter</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@EqualsAndHashCode</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class ConverterData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æˆ‘æƒ³æ‰€æœ‰çš„ å­—ç¬¦ä¸²èµ·å‰é¢åŠ ä¸Š&quot;è‡ªå®šä¹‰ï¼š&quot;ä¸‰ä¸ªå­—</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;, converter = CustomStringStringConverter.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æˆ‘æƒ³å†™åˆ°excel ç”¨å¹´æœˆæ—¥çš„æ ¼å¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @DateTimeFormat(&quot;yyyyå¹´MMæœˆddæ—¥HHæ—¶mmåˆ†ssç§’&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æˆ‘æƒ³å†™åˆ°excel ç”¨ç™¾åˆ†æ¯”è¡¨ç¤º</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @NumberFormat(&quot;#.##%&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;æ•°å­—æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@Data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">public class ConverterData {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æˆ‘æƒ³æ‰€æœ‰çš„ å­—ç¬¦ä¸²èµ·å‰é¢åŠ ä¸Š&quot;è‡ªå®šä¹‰ï¼š&quot;ä¸‰ä¸ªå­—</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;å­—ç¬¦ä¸²æ ‡é¢˜&quot;, converter = CustomStringStringConverter.class)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private String string;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æˆ‘æƒ³å†™åˆ°excel ç”¨å¹´æœˆæ—¥çš„æ ¼å¼</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @DateTimeFormat(&quot;yyyyå¹´MMæœˆddæ—¥HHæ—¶mmåˆ†ssç§’&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(&quot;æ—¥æœŸæ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Date date;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æˆ‘æƒ³å†™åˆ°excel ç”¨ç™¾åˆ†æ¯”è¡¨ç¤º</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @NumberFormat(&quot;#.##%&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @ExcelProperty(value = &quot;æ•°å­—æ ‡é¢˜&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private Double doubleData;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -18">ä»£ç <a class="hash-link" href="#ä»£ç -18" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * å¯å˜æ ‡é¢˜å¤„ç†(åŒ…æ‹¬æ ‡é¢˜å›½é™…åŒ–ç­‰)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * ç®€å•çš„è¯´ç”¨List&lt;List&lt;String&gt;&gt;çš„æ ‡é¢˜ ä½†æ˜¯è¿˜æ”¯æŒæ³¨è§£</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link ConverterData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. ç›´æ¥å†™å³å¯</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void variableTitleWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å†™æ³•1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;variableTitleWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName, ConverterData.class).head(variableTitleHead()).sheet(&quot;æ¨¡æ¿&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private List&lt;List&lt;String&gt;&gt; variableTitleHead() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;List&lt;String&gt;&gt; list = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head0 = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head0.add(&quot;string&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head1 = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head1.add(&quot;number&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head2 = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head2.add(&quot;date&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head2);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }    private List&lt;List&lt;String&gt;&gt; variableTitleHead() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;List&lt;String&gt;&gt; list = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head0 = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head0.add(&quot;string&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head1 = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head1.add(&quot;number&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head2 = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head2.add(&quot;date&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head2);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2></h2><h2 class="anchor anchorWithStickyNavbar_mojV" id="ä¸åˆ›å»ºå¯¹è±¡çš„å†™">ä¸åˆ›å»ºå¯¹è±¡çš„å†™<a class="hash-link" href="#ä¸åˆ›å»ºå¯¹è±¡çš„å†™" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="excelç¤ºä¾‹-19">excelç¤ºä¾‹<a class="hash-link" href="#excelç¤ºä¾‹-19" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p><img loading="lazy" src="https://cdn.nlark.com/yuque/0/2020/png/553000/1584454289882-fd4a4ba9-a800-4a34-bd66-92061d58c21b.png#crop=0&amp;crop=0&amp;crop=1&amp;crop=1&amp;height=245&amp;id=W4eqU&amp;originHeight=245&amp;originWidth=269&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;size=0&amp;status=done&amp;style=none&amp;title=&amp;width=269" class="img_E7b_"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -19">ä»£ç <a class="hash-link" href="#ä»£ç -19" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * ä¸åˆ›å»ºå¯¹è±¡çš„å†™</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void noModelWrite() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // å†™æ³•1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = TestFileUtil.getPath() + &quot;noModelWrite&quot; + System.currentTimeMillis() + &quot;.xlsx&quot;;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(fileName).head(head()).sheet(&quot;æ¨¡æ¿&quot;).doWrite(dataList());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private List&lt;List&lt;String&gt;&gt; head() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;List&lt;String&gt;&gt; list = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head0 = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head0.add(&quot;å­—ç¬¦ä¸²&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head1 = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head1.add(&quot;æ•°å­—&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;String&gt; head2 = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        head2.add(&quot;æ—¥æœŸ&quot; + System.currentTimeMillis());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head0);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head1);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        list.add(head2);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    private List&lt;List&lt;Object&gt;&gt; dataList() {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        List&lt;List&lt;Object&gt;&gt; list = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        for (int i = 0; i &lt; 10; i++) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            List&lt;Object&gt; data = ListUtils.newArrayList();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.add(&quot;å­—ç¬¦ä¸²&quot; + i);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.add(new Date());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            data.add(0.56);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            list.add(data);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        return list;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="webä¸­çš„å†™">webä¸­çš„å†™<a class="hash-link" href="#webä¸­çš„å†™" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="ç¤ºä¾‹ä»£ç -1">ç¤ºä¾‹ä»£ç <a class="hash-link" href="#ç¤ºä¾‹ä»£ç -1" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>DEMOä»£ç åœ°å€ï¼š<a href="https://github.com/alibaba/easyexcel/blob/master/src/test/java/com/alibaba/easyexcel/test/demo/web/WebTest.java" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/easyexcel/blob/master/src/test/java/com/alibaba/easyexcel/test/demo/web/WebTest.java</a></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-19">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-19" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>å‚ç…§ï¼š<a href="#5bd247f4">å¯¹è±¡</a> å°±æ˜¯åç§°å˜äº†ä¸‹</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -20">ä»£ç <a class="hash-link" href="#ä»£ç -20" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æ–‡ä»¶ä¸‹è½½ï¼ˆå¤±è´¥äº†ä¼šè¿”å›ä¸€ä¸ªæœ‰éƒ¨åˆ†æ•°æ®çš„Excelï¼‰</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 1. åˆ›å»ºexcelå¯¹åº”çš„å®ä½“å¯¹è±¡ å‚ç…§{@link DownloadData}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 2. è®¾ç½®è¿”å›çš„ å‚æ•°</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * &lt;p&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * 3. ç›´æ¥å†™ï¼Œè¿™é‡Œæ³¨æ„ï¼Œfinishçš„æ—¶å€™ä¼šè‡ªåŠ¨å…³é—­OutputStream,å½“ç„¶ä½ å¤–é¢å†å…³é—­æµé—®é¢˜ä¸å¤§</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @GetMapping(&quot;download&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void download(HttpServletResponse response) throws IOException {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œæ³¨æ„ æœ‰åŒå­¦ååº”ä½¿ç”¨swagger ä¼šå¯¼è‡´å„ç§é—®é¢˜ï¼Œè¯·ç›´æ¥ç”¨æµè§ˆå™¨æˆ–è€…ç”¨postman</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        response.setContentType(&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        response.setCharacterEncoding(&quot;utf-8&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡ŒURLEncoder.encodeå¯ä»¥é˜²æ­¢ä¸­æ–‡ä¹±ç  å½“ç„¶å’Œeasyexcelæ²¡æœ‰å…³ç³»</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        String fileName = URLEncoder.encode(&quot;æµ‹è¯•&quot;, &quot;UTF-8&quot;).replaceAll(&quot;\\+&quot;, &quot;%20&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        response.setHeader(&quot;Content-disposition&quot;, &quot;attachment;filename*=utf-8&#x27;&#x27;&quot; + fileName + &quot;.xlsx&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        EasyExcel.write(response.getOutputStream(), DownloadData.class).sheet(&quot;æ¨¡æ¿&quot;).doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="webä¸­çš„å†™å¹¶ä¸”å¤±è´¥çš„æ—¶å€™è¿”å›json">webä¸­çš„å†™å¹¶ä¸”å¤±è´¥çš„æ—¶å€™è¿”å›json<a class="hash-link" href="#webä¸­çš„å†™å¹¶ä¸”å¤±è´¥çš„æ—¶å€™è¿”å›json" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h5 class="anchor anchorWithStickyNavbar_mojV" id="since-2">since<a class="hash-link" href="#since-2" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>2.1.1</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="å¯¹è±¡-20">å¯¹è±¡<a class="hash-link" href="#å¯¹è±¡-20" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><p>å‚ç…§ï¼š<a href="#5bd247f4">å¯¹è±¡</a> å°±æ˜¯åç§°å˜äº†ä¸‹</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="ä»£ç -21">ä»£ç <a class="hash-link" href="#ä»£ç -21" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h5><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx" style="color:#bfc7d5;background-color:#292d3e"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#bfc7d5"><span class="token plain">    /**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * æ–‡ä»¶ä¸‹è½½å¹¶ä¸”å¤±è´¥çš„æ—¶å€™è¿”å›jsonï¼ˆé»˜è®¤å¤±è´¥äº†ä¼šè¿”å›ä¸€ä¸ªæœ‰éƒ¨åˆ†æ•°æ®çš„Excelï¼‰</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     *</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     * @since 2.1.1</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     */</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    @GetMapping(&quot;downloadFailedUsingJson&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    public void downloadFailedUsingJson(HttpServletResponse response) throws IOException {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        // è¿™é‡Œæ³¨æ„ æœ‰åŒå­¦ååº”ä½¿ç”¨swagger ä¼šå¯¼è‡´å„ç§é—®é¢˜ï¼Œè¯·ç›´æ¥ç”¨æµè§ˆå™¨æˆ–è€…ç”¨postman</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.setContentType(&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.setCharacterEncoding(&quot;utf-8&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¿™é‡ŒURLEncoder.encodeå¯ä»¥é˜²æ­¢ä¸­æ–‡ä¹±ç  å½“ç„¶å’Œeasyexcelæ²¡æœ‰å…³ç³»</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            String fileName = URLEncoder.encode(&quot;æµ‹è¯•&quot;, &quot;UTF-8&quot;).replaceAll(&quot;\\+&quot;, &quot;%20&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.setHeader(&quot;Content-disposition&quot;, &quot;attachment;filename*=utf-8&#x27;&#x27;&quot; + fileName + &quot;.xlsx&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // è¿™é‡Œéœ€è¦è®¾ç½®ä¸å…³é—­æµ</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            EasyExcel.write(response.getOutputStream(), DownloadData.class).autoCloseStream(Boolean.FALSE).sheet(&quot;æ¨¡æ¿&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                .doWrite(data());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        } catch (Exception e) {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            // é‡ç½®response</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.reset();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.setContentType(&quot;application/json&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.setCharacterEncoding(&quot;utf-8&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            Map&lt;String, String&gt; map = MapUtils.newHashMap();</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            map.put(&quot;status&quot;, &quot;failure&quot;);</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            map.put(&quot;message&quot;, &quot;ä¸‹è½½æ–‡ä»¶å¤±è´¥&quot; + e.getMessage());</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            response.getWriter().println(JSON.toJSONString(map));</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/quickstart/write.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ç¼–è¾‘æ­¤é¡µ</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡æ¡£åˆ†é¡µå¯¼èˆª"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/3.x/quickstart/read"><div class="pagination-nav__sublabel">ä¸Šä¸€é¡µ</div><div class="pagination-nav__label">è¯»Excel</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/3.x/quickstart/fil"><div class="pagination-nav__sublabel">ä¸‹ä¸€é¡µ</div><div class="pagination-nav__label">å¡«å……Excel</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ç¤ºä¾‹ä»£ç " class="table-of-contents__link toc-highlight">ç¤ºä¾‹ä»£ç </a></li><li><a href="#æœ€ç®€å•çš„å†™" class="table-of-contents__link toc-highlight">æœ€ç®€å•çš„å†™</a></li><li><a href="#æ ¹æ®å‚æ•°åªå¯¼å‡ºæŒ‡å®šåˆ—" class="table-of-contents__link toc-highlight">æ ¹æ®å‚æ•°åªå¯¼å‡ºæŒ‡å®šåˆ—</a></li><li><a href="#æŒ‡å®šå†™å…¥çš„åˆ—" class="table-of-contents__link toc-highlight">æŒ‡å®šå†™å…¥çš„åˆ—</a></li><li><a href="#å¤æ‚å¤´å†™å…¥" class="table-of-contents__link toc-highlight">å¤æ‚å¤´å†™å…¥</a></li><li><a href="#é‡å¤å¤šæ¬¡å†™å…¥å†™åˆ°å•ä¸ªæˆ–è€…å¤šä¸ªsheet" class="table-of-contents__link toc-highlight">é‡å¤å¤šæ¬¡å†™å…¥(å†™åˆ°å•ä¸ªæˆ–è€…å¤šä¸ªSheet)</a></li><li><a href="#æ—¥æœŸæ•°å­—æˆ–è€…è‡ªå®šä¹‰æ ¼å¼è½¬æ¢" class="table-of-contents__link toc-highlight">æ—¥æœŸã€æ•°å­—æˆ–è€…è‡ªå®šä¹‰æ ¼å¼è½¬æ¢</a></li><li><a href="#å›¾ç‰‡å¯¼å‡º" class="table-of-contents__link toc-highlight">å›¾ç‰‡å¯¼å‡º</a></li><li><a href="#è¶…é“¾æ¥å¤‡æ³¨å…¬å¼æŒ‡å®šå•ä¸ªå•å…ƒæ ¼çš„æ ·å¼å•ä¸ªå•å…ƒæ ¼å¤šç§æ ·å¼" class="table-of-contents__link toc-highlight">è¶…é“¾æ¥ã€å¤‡æ³¨ã€å…¬å¼ã€æŒ‡å®šå•ä¸ªå•å…ƒæ ¼çš„æ ·å¼ã€å•ä¸ªå•å…ƒæ ¼å¤šç§æ ·å¼</a></li><li><a href="#æ ¹æ®æ¨¡æ¿å†™å…¥" class="table-of-contents__link toc-highlight">æ ¹æ®æ¨¡æ¿å†™å…¥</a></li><li><a href="#åˆ—å®½è¡Œé«˜" class="table-of-contents__link toc-highlight">åˆ—å®½ã€è¡Œé«˜</a></li><li><a href="#æ³¨è§£å½¢å¼è‡ªå®šä¹‰æ ·å¼" class="table-of-contents__link toc-highlight">æ³¨è§£å½¢å¼è‡ªå®šä¹‰æ ·å¼</a></li><li><a href="#è‡ªå®šä¹‰æ ·å¼" class="table-of-contents__link toc-highlight">è‡ªå®šä¹‰æ ·å¼</a></li><li><a href="#åˆå¹¶å•å…ƒæ ¼" class="table-of-contents__link toc-highlight">åˆå¹¶å•å…ƒæ ¼</a></li><li><a href="#ä½¿ç”¨tableå»å†™å…¥" class="table-of-contents__link toc-highlight">ä½¿ç”¨tableå»å†™å…¥</a></li><li><a href="#åŠ¨æ€å¤´å®æ—¶ç”Ÿæˆå¤´å†™å…¥" class="table-of-contents__link toc-highlight">åŠ¨æ€å¤´ï¼Œå®æ—¶ç”Ÿæˆå¤´å†™å…¥</a></li><li><a href="#è‡ªåŠ¨åˆ—å®½ä¸å¤ªç²¾ç¡®" class="table-of-contents__link toc-highlight">è‡ªåŠ¨åˆ—å®½(ä¸å¤ªç²¾ç¡®)</a></li><li><a href="#è‡ªå®šä¹‰æ‹¦æˆªå™¨ä¸Šé¢å‡ ç‚¹éƒ½ä¸ç¬¦åˆä½†æ˜¯è¦å¯¹å•å…ƒæ ¼è¿›è¡Œæ“ä½œçš„å‚ç…§è¿™ä¸ª" class="table-of-contents__link toc-highlight">è‡ªå®šä¹‰æ‹¦æˆªå™¨ï¼ˆä¸Šé¢å‡ ç‚¹éƒ½ä¸ç¬¦åˆä½†æ˜¯è¦å¯¹å•å…ƒæ ¼è¿›è¡Œæ“ä½œçš„å‚ç…§è¿™ä¸ªï¼‰</a></li><li><a href="#æ’å…¥æ‰¹æ³¨" class="table-of-contents__link toc-highlight">æ’å…¥æ‰¹æ³¨</a></li><li><a href="#å¯å˜æ ‡é¢˜å¤„ç†åŒ…æ‹¬æ ‡é¢˜å›½é™…åŒ–ç­‰" class="table-of-contents__link toc-highlight">å¯å˜æ ‡é¢˜å¤„ç†(åŒ…æ‹¬æ ‡é¢˜å›½é™…åŒ–ç­‰)</a></li><li><a href="#ä¸åˆ›å»ºå¯¹è±¡çš„å†™" class="table-of-contents__link toc-highlight">ä¸åˆ›å»ºå¯¹è±¡çš„å†™</a></li><li><a href="#webä¸­çš„å†™" class="table-of-contents__link toc-highlight">webä¸­çš„å†™</a></li><li><a href="#webä¸­çš„å†™å¹¶ä¸”å¤±è´¥çš„æ—¶å€™è¿”å›json" class="table-of-contents__link toc-highlight">webä¸­çš„å†™å¹¶ä¸”å¤±è´¥çš„æ—¶å€™è¿”å›json</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/3.x/">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/3.x/">Second Doc</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_gHmE"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_W2Cr themedImage--light_TfLj footer__logo"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2022 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9214ad1a.js"></script>
<script src="/assets/js/main.834bc3ec.js"></script>
</body>
</html>